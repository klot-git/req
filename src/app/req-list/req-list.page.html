<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button></ion-menu-button>
    </ion-buttons>
    <ion-title>Requirements</ion-title>    
  </ion-toolbar>
</ion-header>

<ion-content>

  <form [formGroup]="form">  

  <ion-list class="req-list" cdkDropList (cdkDropListDropped)="onDrop($event, epics)">

    <!-- <ion-item *ngFor="let req of requirements" [routerLink]="'/requirements/' + req.reqId"> -->        
    <div *ngFor="let epic of epics">
      
      <ion-item 
        class="req-item"
        (click)="selectEpic(epic)"
        cdkDrag>

        <div class="req-placeholder" *cdkDragPlaceholder></div>
      
        <!-- <div *cdkDragPreview>
          MOVING EPIC
        </div> -->

        <ion-label class="req-label">
          <div class="req-code">{{epic.reqCode}}</div>
          {{epic.name}}
          <ion-icon (click)="toStory(epic)" name="arrow-forward-outline"></ion-icon>

          <!-- stories -->
          <ion-list *ngIf="epic.childs" cdkDropList (cdkDropListDropped)="onDrop($event, epic.childs)">
            <ion-item 
              class="req-item"
              *ngFor="let story of epic.childs"
              cdkDrag>

              <div class="req-placeholder" *cdkDragPlaceholder></div>

              <ion-label class="req-label story">
                <div class="req-code">{{story.reqCode}}</div>
                {{story.name}}
                <ion-icon (click)="toEpic(story)" name="arrow-back-outline"></ion-icon>      

                <ion-icon name="reorder-two-outline" class="reorder-handle" cdkDragHandle></ion-icon>

              </ion-label>            
            </ion-item> 
          </ion-list>

          <ion-icon name="reorder-two-outline" class="reorder-handle" cdkDragHandle></ion-icon>

        </ion-label>
      </ion-item>
      <ion-item *ngIf="epic==selectedEpic" lines="none">    
        <ion-input placeholder="New requirement" formControlName="newRequirement"></ion-input>          
        <ion-button color="primary" slot="end" (click)="addRequirement()">Add</ion-button>
      </ion-item>
    </div>

  </ion-list>

  <ion-item *ngIf="!selectedEpic" lines="none">    
    <ion-input placeholder="New requirement" formControlName="newRequirement"></ion-input>          
    <ion-button color="primary" slot="end" (click)="addRequirement()">Add</ion-button>
  </ion-item>

  </form>


  
    
      

</ion-content>
